services:
  crm:
    build: .
    container_name: crm-yunduan
    ports:
      # 修改左边的端口号即可，格式：主机端口:容器端口
      - "8080:3000"
    volumes:
      # 持久化数据库文件
      - crm-data:/app/prisma
    environment:
      - DATABASE_URL=file:./prisma/dev.db
      - AUTH_SECRET=crm-yunduan-secret-key-2024
      # 部署时修改为实际域名或IP
      - NEXTAUTH_URL=http://localhost:8080
      # 信任代理主机（Docker部署必需）
      - AUTH_TRUST_HOST=true
    restart: unless-stopped

# 使用命名卷持久化数据
volumes:
  crm-data:
